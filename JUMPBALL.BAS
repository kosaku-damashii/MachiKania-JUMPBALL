REM JUMPBALL
USEGRAPHIC 9
USEVAR MAXNUM,MAXW,MAXH,WAVE,ORGH,DIG,CLR,OLDX,OLDY,DIRECT
MAXNUM=30
DIM X#(MAXNUM),WAVE#(MAXNUM),OLDX(MAXNUM),OLDY(MAXNUM),ORGH#(MAXNUM),DIG#(MAXNUM),CLR(MAXNUM),DIRECT(I)
MAXW=SYSTEM(22):MAXH=SYSTEM(23)
T=5
FOR I=0 TO MAXNUM-1
  X#(I)=FLOAT#(RND()*MAXW/32767)
  ORGH#(I)=50+FLOAT#(RND()*(MAXH-50)/32767)
  DIG#(I)=FLOAT#(RND()*90/32767)
  CLR(I)=I%7+1
  IF RND()%2=0 THEN
    DIRECT(I)=-1
  ELSE
    DIRECT(I)=1
  ENDIF
NEXT
DO
  FOR I=0 TO MAXNUM-1
    CIRCLEFILL OLDX(I),OLDY(I),T,0x08
    OLDX(I)=INT(X#(I))
    DIG#(I)=DIG#(I)+0.05
    OLDY(I)=MAXH-ABS(INT(SIN#(DIG#(I))*ORGH#(I)))
    CIRCLEFILL OLDX(I),OLDY(I),T,CLR(I)+8
    CIRCLEFILL OLDX(I)+1,OLDY(I)-1,T-2,CLR(I)
    IF INKEY()!=0 THEN BREAK
    X#(I)=X#(I)+FLOAT#(DIRECT(I))
    IF X#(I)=0 THEN
      DIRECT(I)=1
    ELSEIF INT(X#(I))>=MAXW THEN
      DIRECT(I)=-1
      X#(I)=FLOAT#(MAXW-1)
    ENDIF
  NEXT
LOOP WHILE INKEY()=0
END
